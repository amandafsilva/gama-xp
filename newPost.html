<!DOCTYPE html>
<html>
<head>

	<title></title>

	<meta charset="utf-8">

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<meta name='description' content=''>

	<meta name='keywords' content=''>

	<meta name='author' content='Força-Tarefa'>

	<link rel="stylesheet" type="text/css" href="css/style.css">

	<link href="https://fonts.googleapis.com/css?family=Poppins" rel="stylesheet">

	<script src="https://cdn.ckeditor.com/ckeditor5/11.2.0/classic/ckeditor.js"></script>

	<style type="text/css">
		main {
			margin: 200px 0;
		}

		#editorPosi {
			width: 1024px;
			margin: auto;
		}

		#post-send-btn {
			border-radius: 30px;
			box-shadow: 0px 3px 5px silver;
			transition: all .5s;
			height: 40px;
			width: 120px;
			color: white;
			border: none;
			background: #ebc70a;
			margin-top: 30px;
			cursor: pointer;
		}
		#post-send-btn:hover{
			box-shadow: none;
		}
	</style>

</head>
<body>
	<header>
		<div class="header-body">
			<div class="header-logo">
				<a href="index.html"><img src="img/logo.png"></a>
			</div>
		</div>
	</header>

	<main>
		<div id="editorPosi">
		<h1>Faça um post</h1>
			<form enctype="multipart/form-data" onsubmit="sendPost(event)">
			    <textarea name="content" id="editor">
			        
			    </textarea>
			    <input type="text" name="" id="nameuserpost" placeholder="Nome do escritor">
				<input type="text" name="" id="categoriapost" placeholder="Categoria do Post">
				<input type="text" name="" id="resumopost" placeholder="Resumo do Post">
				<input type="text" name="" id="titulopost" placeholder="Titulo do Post">
			    <input type="submit" value="Enviar" id="post-send-btn">
			</form>
		</div>

	</main>

	<footer>
		<div class="footer-body">
			<img src="img/logo.png" class="logofooter">
			<div>
				<p class="footer-title">Siga a nossa fanpage!</p>
				<div class="footer-container">
					<img src="img/fb-logo.png"/>
					<span class="footer-text">/dataquestbh</span>
				</div>
			</div>
		</div>
		<div class="footer-copyright">
			Dataquest © 2019. Todos os direitos reservados.
		</div>
	</footer>

	<script>
		let menuOpen = false
		function menu(){
			if(menuOpen == false) {
				document.querySelector('.max550').style = 'transition: all .5s; left: 0;';
				menuOpen = true
			}else {
				document.querySelector('.max550').style = 'transition: all .5s; left: -50%';
				menuOpen = false;
			}
		}
	</script>

	<script>
		let myEditor;
        ClassicEditor
            .create( document.querySelector( '#editor' ) ).then(editor => myEditor = editor)
            .catch( error => {
                console.error( error );
            } );
    </script>

    <script type="text/javascript">
    	function sendPost(e){
    		e.preventDefault()

    		fetch('https://gamaexp17-1.herokuapp.com/post', { method: 'post', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify({
					text: myEditor.getData(),
					escritor: document.querySelector('#nameuserpost').value,
					categoria: document.querySelector('#categoriapost').value,
					resumo: document.querySelector('#resumopost').value,
					titulo: document.querySelector('#titulopost').value
    			})
    		}).then((resp) => {
    			if(resp.status == 200){
    				resp.json().then((r) => {
						window.location.href = 'index.html';
    				})
    			}else{
    				alert('Não cadastrou')
    			}
    		}).catch(err => alert(err))
    	}
    </script>

</body>
</html>